name: ðŸ¤–Add PR to Project


defaults:
  run:
    shell: pwsh


on:
  workflow_dispatch:
  pull_request:
    types: opened


jobs:
  add_pr_to_project:
    name: Add PR To Project
    runs-on: ubuntu-latest
    steps:
    - name: Set Up Deno
      uses: denoland/setup-deno@v1
      with:
        deno-version: v1.x

    - name: Add PR
      run: |
        <# Script Args:
          Repo Name
          Issue Number
          Issue Type: 'issue' or 'pr'
          Project To Add PR To
          Token
        #>

        $scriptUrl = "${{ vars.SCRIPT_BASE_URL }}/${{ vars.CICD_SCRIPTS_VERSION }}/${{ vars.SCRIPT_RELATIVE_DIR_PATH }}/add-item-to-project.ts";

        deno run `
          --allow-read `
          --allow-net=api.github.com `
          "$scriptUrl" `
          "${{ vars.PROJECT_NAME }}" `
          "${{ github.event.number }}" `
          "pull-request" `
          "${{ vars.ORG_PROJECT_NAME }}" `
          "${{ secrets.CICD_REST_API }}";
